{"ast":null,"code":"var _jsxFileName = \"/Users/Cooper/Bluxury_Catering/bluxury-catering copy 4/src/contexts/CartContext.jsx\";\nimport React, { createContext, useReducer } from \"react\";\nimport { CartReducer, sumItems } from \"./CartReducer\";\nimport firebase, { auth } from \"../services/firebase\";\nimport axios from \"axios\";\nexport const CartContext = createContext();\nconst storage = localStorage.getItem(\"cart\") ? JSON.parse(localStorage.getItem(\"cart\")) : [];\nconst initialState = {\n  cartItems: storage,\n  ...sumItems(storage),\n  checkout: false\n};\nconst contextValues = {\n  removeProduct,\n  addProduct,\n  increase,\n  decrease,\n  clearCart,\n  handleCheckout,\n  total,\n  ...state\n};\nconsole.log(contextValues);\n\nconst CartContextProvider = ({\n  children\n}) => {\n  const [state, dispatch] = useReducer(CartReducer, initialState);\n\n  const increase = payload => {\n    dispatch({\n      type: \"INCREASE\",\n      payload\n    });\n  };\n\n  const decrease = payload => {\n    dispatch({\n      type: \"DECREASE\",\n      payload\n    });\n  };\n\n  const addProduct = payload => {\n    dispatch({\n      type: \"ADD_ITEM\",\n      payload\n    });\n  };\n\n  const removeProduct = payload => {\n    dispatch({\n      type: \"REMOVE_ITEM\",\n      payload\n    });\n  };\n\n  const clearCart = () => {\n    dispatch({\n      type: \"CLEAR\"\n    });\n  };\n\n  const makeid = length => {\n    let result = \"\";\n    const characters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n    const charactersLength = characters.length;\n\n    for (var i = 0; i < length; i++) {\n      result += characters.charAt(Math.floor(Math.random() * charactersLength));\n    }\n\n    return result;\n  };\n\n  const handleCheckout = () => {\n    console.log(\"CHECKOUT\", state);\n    const order = {\n      MerchantTradeNo: makeid(20),\n      MerchantTradeDate: \"2020/09/07 23:00:00\",\n      TotalAmount: total,\n      TradeDesc: \"測試交易描述\",\n      ItemName: \"測試商品\",\n      ReturnURL: \"http://192.168.0.1\"\n    };\n    console.log(total);\n    window.open(\"http://localhost:5000/pay\");\n    dispatch({\n      type: \"CHECKOUT\"\n    });\n    var consumer = \"\";\n\n    if (auth.currentUser) {\n      consumer = auth.currentUser.uid;\n    }\n\n    const purchaseDate = firebase.firestore.Timestamp.fromDate(new Date()).toDate();\n    firebase.firestore().collection(\"consumption\").doc(purchaseDate.toString()).set({\n      items: state,\n      purchaseDate: purchaseDate,\n      consumer: consumer\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(CartContext.Provider, {\n    value: contextValues,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 5\n    }\n  }, children);\n};\n\nexport default CartContextProvider;","map":{"version":3,"sources":["/Users/Cooper/Bluxury_Catering/bluxury-catering copy 4/src/contexts/CartContext.jsx"],"names":["React","createContext","useReducer","CartReducer","sumItems","firebase","auth","axios","CartContext","storage","localStorage","getItem","JSON","parse","initialState","cartItems","checkout","contextValues","removeProduct","addProduct","increase","decrease","clearCart","handleCheckout","total","state","console","log","CartContextProvider","children","dispatch","payload","type","makeid","length","result","characters","charactersLength","i","charAt","Math","floor","random","order","MerchantTradeNo","MerchantTradeDate","TotalAmount","TradeDesc","ItemName","ReturnURL","window","open","consumer","currentUser","uid","purchaseDate","firestore","Timestamp","fromDate","Date","toDate","collection","doc","toString","set","items"],"mappings":"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","sourcesContent":["import React, { createContext, useReducer } from \"react\";\nimport { CartReducer, sumItems } from \"./CartReducer\";\nimport firebase, { auth } from \"../services/firebase\";\nimport axios from \"axios\";\n\nexport const CartContext = createContext();\n\nconst storage = localStorage.getItem(\"cart\")\n  ? JSON.parse(localStorage.getItem(\"cart\"))\n  : [];\nconst initialState = {\n  cartItems: storage,\n  ...sumItems(storage),\n  checkout: false,\n};\n\nconst contextValues = {\n  removeProduct,\n  addProduct,\n  increase,\n  decrease,\n  clearCart,\n  handleCheckout,\n  total,\n  ...state,\n};\nconsole.log(contextValues);\n\nconst CartContextProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(CartReducer, initialState);\n\n  const increase = (payload) => {\n    dispatch({ type: \"INCREASE\", payload });\n  };\n\n  const decrease = (payload) => {\n    dispatch({ type: \"DECREASE\", payload });\n  };\n\n  const addProduct = (payload) => {\n    dispatch({ type: \"ADD_ITEM\", payload });\n  };\n\n  const removeProduct = (payload) => {\n    dispatch({ type: \"REMOVE_ITEM\", payload });\n  };\n\n  const clearCart = () => {\n    dispatch({ type: \"CLEAR\" });\n  };\n\n  const makeid = (length) => {\n    let result = \"\";\n    const characters =\n      \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n    const charactersLength = characters.length;\n    for (var i = 0; i < length; i++) {\n      result += characters.charAt(Math.floor(Math.random() * charactersLength));\n    }\n    return result;\n  };\n\n  const handleCheckout = () => {\n    console.log(\"CHECKOUT\", state);\n    const order = {\n      MerchantTradeNo: makeid(20),\n      MerchantTradeDate: \"2020/09/07 23:00:00\",\n      TotalAmount: total,\n      TradeDesc: \"測試交易描述\",\n      ItemName: \"測試商品\",\n      ReturnURL: \"http://192.168.0.1\",\n    };\n    console.log(total);\n    window.open(\"http://localhost:5000/pay\");\n\n    dispatch({ type: \"CHECKOUT\" });\n    var consumer = \"\";\n    if (auth.currentUser) {\n      consumer = auth.currentUser.uid;\n    }\n    const purchaseDate = firebase.firestore.Timestamp.fromDate(\n      new Date()\n    ).toDate();\n    firebase\n      .firestore()\n      .collection(\"consumption\")\n      .doc(purchaseDate.toString())\n      .set({\n        items: state,\n        purchaseDate: purchaseDate,\n        consumer: consumer,\n      });\n  };\n\n  return (\n    <CartContext.Provider value={contextValues}>\n      {children}\n    </CartContext.Provider>\n  );\n};\n\nexport default CartContextProvider;\n"]},"metadata":{},"sourceType":"module"}