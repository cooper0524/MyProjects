{"ast":null,"code":"import _slicedToArray from\"/Users/Cooper/Bluxury_Catering/bluxury-catering copy 3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import CustomField from\"../common/CustomField\";import{Formik,Form,Field,ErrorMessage}from\"formik\";import BootForm from\"react-bootstrap/Form\";import{Button}from\"react-bootstrap\";import*as Yup from\"yup\";import firebase,{storage}from\"../services/firebase\";var ProductForm=function ProductForm(_ref){var categories=_ref.categories,onCloseModal=_ref.onCloseModal;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(\"https://scontent.ftpe12-1.fna.fbcdn.net/v/t31.0-0/p206x206/22712353_648259815562546_9040069549059309313_o.jpg?_nc_cat=104&_nc_sid=09cbfe&_nc_ohc=4RxqhClM2n0AX9KLJX_&_nc_ht=scontent.ftpe12-1.fna&_nc_tp=6&oh=c2710cb7a11d7c2f90527348f4d35902&oe=5F624FE0\"),_useState4=_slicedToArray(_useState3,2),url=_useState4[0],setUrl=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),progress=_useState6[0],setProgress=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),title=_useState8[0],setTitle=_useState8[1];var _useState9=useState(categories[0]),_useState10=_slicedToArray(_useState9,2),category=_useState10[0],setCategory=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),price=_useState12[0],setPrice=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),xPrice=_useState14[0],setXPrice=_useState14[1];var handleImgDisplay=function handleImgDisplay(event){setImage(event.target.files[0]);};var handleUpload=function handleUpload(e){e.preventDefault();var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on(\"state_changed\",function(snapshot){var progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){console.log(error);},function(){storage.ref(\"images\").child(image.name).getDownloadURL().then(function(url){setUrl(url);});});};var handleSubmit=function handleSubmit(){if(title.trim()===\"\"){alert(\"?\");}else{var editTime=firebase.firestore.Timestamp.fromDate(new Date()).toDate();firebase.firestore().collection(\"products\").doc(editTime.toString()).set({title:title,category:category,price:price,xPrice:xPrice,url:url,editTime:editTime}).then(onCloseModal);}};var validationSchema=Yup.object().shape({title:Yup.string().required(\"First Name is required\"),category:Yup.string().required(\"Email is required\"),price:Yup.string().required(\"Password is required\"),xPrice:Yup.string()});var initialValues={title:title,category:category,price:price,xPrice:xPrice};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"section\",{id:\"productForm\"},/*#__PURE__*/React.createElement(\"progress\",{id:\"progress\",value:progress,max:\"100\"}),/*#__PURE__*/React.createElement(BootForm,null,/*#__PURE__*/React.createElement(\"img\",{className:\"d-flex m-auto\",src:url,alt:\"productImg\",height:\"200px\",width:\"100%\"}),/*#__PURE__*/React.createElement(BootForm.File,{id:\"exampleFormControlFile1\",label:\"\\u9078\\u53D6\\u5716\\u7247\",onChange:handleImgDisplay}),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center pt-2\"},/*#__PURE__*/React.createElement(Button,{variant:\"danger\",type:\"button\",onClick:handleUpload},\"\\u65B0\\u589E\")))),/*#__PURE__*/React.createElement(Formik,{initialValues:initialValues,validationSchema:validationSchema,onSubmit:handleSubmit},function(_ref2){var errors=_ref2.errors,touched=_ref2.touched;return/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(CustomField,{label:\"\\u7522\\u54C1\\u540D\\u7A31\",name:\"title\",errors:errors.title,touched:touched.title,onKeyUp:function onKeyUp(e){setTitle(e.target.value);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group text-left\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"category\"},\"\\u7522\\u54C1\\u985E\\u5225\"),/*#__PURE__*/React.createElement(Field,{as:\"select\",label:\"\\u7522\\u54C1\\u985E\\u5225\",name:\"category\",onBlur:function onBlur(e){setCategory(e.target.value);},className:\"form-control\"+(errors.category&&touched.category?\" is-invalid\":\"\")},categories.map(function(category){return/*#__PURE__*/React.createElement(\"option\",{key:category,value:category},category);})),/*#__PURE__*/React.createElement(ErrorMessage,{name:\"category\",component:\"div\",className:\"invalid-feedback\"})),/*#__PURE__*/React.createElement(CustomField,{label:\"\\u5B9A\\u50F9\",name:\"price\",errors:errors.price,touched:touched.price,onKeyUp:function onKeyUp(e){setPrice(e.target.value);}}),/*#__PURE__*/React.createElement(CustomField,{label:\"\\u7279\\u50F9\",name:\"xPrice\",placeholder:\"\\u7121\\u7279\\u50F9\\u8ACB\\u7A7A\\u767D\",errors:errors.xPrice,touched:touched.xPrice,onKeyUp:function onKeyUp(e){setXPrice(e.target.value);}}),/*#__PURE__*/React.createElement(Button,{variant:\"primary\",type:\"submit\",value:\"Submit\",block:true},\"\\u65B0\\u589E\"));}));};export default ProductForm;","map":{"version":3,"sources":["/Users/Cooper/Bluxury_Catering/bluxury-catering copy 3/src/components/ProductForm.jsx"],"names":["React","useState","CustomField","Formik","Form","Field","ErrorMessage","BootForm","Button","Yup","firebase","storage","ProductForm","categories","onCloseModal","image","setImage","url","setUrl","progress","setProgress","title","setTitle","category","setCategory","price","setPrice","xPrice","setXPrice","handleImgDisplay","event","target","files","handleUpload","e","preventDefault","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","child","getDownloadURL","then","handleSubmit","trim","alert","editTime","firestore","Timestamp","fromDate","Date","toDate","collection","doc","toString","set","validationSchema","object","shape","string","required","initialValues","errors","touched","value","map"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport CustomField from \"../common/CustomField\";\nimport { Formik, Form, Field, ErrorMessage } from \"formik\";\nimport BootForm from \"react-bootstrap/Form\";\nimport { Button } from \"react-bootstrap\";\nimport * as Yup from \"yup\";\nimport firebase, { storage } from \"../services/firebase\";\n\nconst ProductForm = ({ categories, onCloseModal }) => {\n  const [image, setImage] = useState(null);\n  const [url, setUrl] = useState(\n    \"https://scontent.ftpe12-1.fna.fbcdn.net/v/t31.0-0/p206x206/22712353_648259815562546_9040069549059309313_o.jpg?_nc_cat=104&_nc_sid=09cbfe&_nc_ohc=4RxqhClM2n0AX9KLJX_&_nc_ht=scontent.ftpe12-1.fna&_nc_tp=6&oh=c2710cb7a11d7c2f90527348f4d35902&oe=5F624FE0\"\n  );\n  const [progress, setProgress] = useState(0);\n  const [title, setTitle] = useState(\"\");\n  const [category, setCategory] = useState(categories[0]);\n  const [price, setPrice] = useState(\"\");\n  const [xPrice, setXPrice] = useState(\"\");\n\n  const handleImgDisplay = (event) => {\n    setImage(event.target.files[0]);\n  };\n\n  const handleUpload = (e) => {\n    e.preventDefault();\n    const uploadTask = storage.ref(`images/${image.name}`).put(image);\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {\n        const progress = Math.round(\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n        );\n        setProgress(progress);\n      },\n      (error) => {\n        console.log(error);\n      },\n      () => {\n        storage\n          .ref(\"images\")\n          .child(image.name)\n          .getDownloadURL()\n          .then((url) => {\n            setUrl(url);\n          });\n      }\n    );\n  };\n\n  const handleSubmit = () => {\n    if (title.trim() === \"\") {\n      alert(\"?\");\n    } else {\n      const editTime = firebase.firestore.Timestamp.fromDate(\n        new Date()\n      ).toDate();\n      firebase\n        .firestore()\n        .collection(\"products\")\n        .doc(editTime.toString())\n        .set({\n          title,\n          category,\n          price,\n          xPrice,\n          url,\n          editTime,\n        })\n        .then(onCloseModal);\n    }\n  };\n\n  const validationSchema = Yup.object().shape({\n    title: Yup.string().required(\"First Name is required\"),\n    category: Yup.string().required(\"Email is required\"),\n    price: Yup.string().required(\"Password is required\"),\n    xPrice: Yup.string(),\n  });\n\n  const initialValues = {\n    title: title,\n    category: category,\n    price: price,\n    xPrice: xPrice,\n  };\n\n  return (\n    <div>\n      <section id=\"productForm\">\n        <progress id=\"progress\" value={progress} max=\"100\" />\n        <BootForm>\n          <img\n            className=\"d-flex m-auto\"\n            src={url}\n            alt=\"productImg\"\n            height=\"200px\"\n            width=\"100%\"\n          />\n          <BootForm.File\n            id=\"exampleFormControlFile1\"\n            label=\"選取圖片\"\n            onChange={handleImgDisplay}\n          />\n          <div className=\"d-flex justify-content-center pt-2\">\n            <Button variant=\"danger\" type=\"button\" onClick={handleUpload}>\n              新增\n            </Button>\n          </div>\n        </BootForm>\n      </section>\n\n      <Formik\n        initialValues={initialValues}\n        validationSchema={validationSchema}\n        onSubmit={handleSubmit}\n      >\n        {({ errors, touched }) => (\n          <Form>\n            <CustomField\n              label=\"產品名稱\"\n              name=\"title\"\n              errors={errors.title}\n              touched={touched.title}\n              onKeyUp={(e) => {\n                setTitle(e.target.value);\n              }}\n            />\n            <div className=\"form-group text-left\">\n              <label htmlFor=\"category\">產品類別</label>\n              <Field\n                as=\"select\"\n                label=\"產品類別\"\n                name=\"category\"\n                onBlur={(e) => {\n                  setCategory(e.target.value);\n                }}\n                className={\n                  \"form-control\" +\n                  (errors.category && touched.category ? \" is-invalid\" : \"\")\n                }\n              >\n                {categories.map((category) => (\n                  <option key={category} value={category}>\n                    {category}\n                  </option>\n                ))}\n              </Field>\n\n              <ErrorMessage\n                name=\"category\"\n                component=\"div\"\n                className=\"invalid-feedback\"\n              />\n            </div>\n\n            <CustomField\n              label=\"定價\"\n              name=\"price\"\n              errors={errors.price}\n              touched={touched.price}\n              onKeyUp={(e) => {\n                setPrice(e.target.value);\n              }}\n            />\n            <CustomField\n              label=\"特價\"\n              name=\"xPrice\"\n              placeholder=\"無特價請空白\"\n              errors={errors.xPrice}\n              touched={touched.xPrice}\n              onKeyUp={(e) => {\n                setXPrice(e.target.value);\n              }}\n            />\n\n            <Button variant=\"primary\" type=\"submit\" value=\"Submit\" block>\n              新增\n            </Button>\n          </Form>\n        )}\n      </Formik>\n    </div>\n  );\n};\n\nexport default ProductForm;\n"]},"metadata":{},"sourceType":"module"}